#!/usr/bin/env ruby
#
# InstantSlackBot Class based example
#   http://github.com/robzr/instant-slack-bot
#
require 'pp'
require_relative '../instant_slack_bot'

instabot_options = { 
  token: ENV['SLACK_TOKEN'],
  options: {
    debug: true,
    post_options: {
      icon_emoji: ':partly_sunny:'
} } }

class MyBot < InstantSlackBot::Bot
  def conditions(arg)
    return true if message['channel'] =~ /^bot_heaven/
    return true if message['text'] =~ /^test/
    return true if message['username'] =~ /^r/
    true
  end

  def action(arg)
puts "MyBot#action"
pp arg
    "*I am responding* _to_ @#{message['username']} in channel ##{message['channelname']}\n"
  end
end

#condition = MyModule::Conditions.new
#action = MyModule::Action.new

master = InstantSlackBot::Master.new(instabot_options)
my_bot = MyBot.new
pp my_bot.class.superclass
master << my_bot
master.run
